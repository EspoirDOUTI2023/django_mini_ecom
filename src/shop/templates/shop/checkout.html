{% extends 'shop/base.html'%}
{% block content%}
<section class="bg-white pb-8 antialiased md:pb-16">
    <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">
        <h2 class="text-xl font-semibold text-gray-900 sm:text-2xl">Shopping Cart</h2>
        <div class="mt-6 sm:mt-8 md:gap-6 lg:flex lg:items-start xl:gap-8" id="full_container">
            <div class="mx-auto w-full flex-none lg:max-w-2xl xl:max-w-3xl">
                <div class="space-y-6" id="cart_items"></div>
            </div>
            <div class="mx-auto mt-6 max-w-4xl flex-1 space-y-6 lg:mt-0 lg:w-full">
                <div class="space-y-4 rounded-lg border border-gray-200 bg-white p-4 shadow-sm sm:p-6">
                    <p class="text-xl font-semibold text-gray-900">Order summary</p>
                    <div class="space-y-4">
                        <div class="space-y-2">
                            <dl class="flex items-center justify-between gap-4">
                                <dt class="text-base font-normal text-gray-500">Original price</dt>
                                <dd class="text-base font-medium text-gray-900" id="original-price"></dd>
                            </dl>

                            <dl class="flex items-center justify-between gap-4">
                                <dt class="text-base font-normal text-gray-500">Savings</dt>
                                <dd class="text-base font-medium text-green-600">-$0.00</dd>
                            </dl>

                            <dl class="flex items-center justify-between gap-4">
                                <dt class="text-base font-normal text-gray-500">Store Pickup</dt>
                                <dd class="text-base font-medium text-gray-900">$0</dd>
                            </dl>

                            <dl class="flex items-center justify-between gap-4">
                                <dt class="text-base font-normal text-gray-500">Tax</dt>
                                <dd class="text-base font-medium text-gray-900">$0</dd>
                            </dl>
                        </div>

                        <dl class="flex items-center justify-between gap-4 border-t border-gray-200 pt-2">
                            <dt class="text-base font-bold text-gray-900">Total</dt>
                            <dd class="text-base font-bold text-gray-900" id="total-price"></dd>
                        </dl>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div class="flex items-center justify-center px-4" id="checkout-form">
    <!-- Author: FormBold Team -->
    <div class="mx-auto w-full bg-white">
        <form method="POST">
            {% csrf_token %}
            <input type="hidden" name="items" id="items">
            <input type="hidden" name="amount" id="amount" readonly>
            <div class="-mx-3 flex flex-wrap">
                <div class="w-full px-3 sm:w-1/2">
                    <div class="mb-5">
                        <label for="name" class="mb-3 block text-base font-medium text-[#07074D]">
                            Name
                        </label>
                        <input type="text" name="name" id="name" required
                            class="w-full rounded-md border border-[#e0e0e0] bg-white py-3 px-6 text-base font-medium text-[#6B7280] outline-none focus:border-[#6A64F1] focus:shadow-md" />
                    </div>
                </div>
                <div class="w-full px-3 sm:w-1/2">
                    <div class="mb-5">
                        <label for="email" class="mb-3 block text-base font-medium text-[#07074D]">
                            Email
                        </label>
                        <input type="email" name="email" id="email" required
                            class="w-full rounded-md border border-[#e0e0e0] bg-white py-3 px-6 text-base font-medium text-[#6B7280] outline-none focus:border-[#6A64F1] focus:shadow-md" />
                    </div>
                </div>
            </div>

            <div class="-mx-3 flex flex-wrap">
                <div class="w-full px-3 sm:w-1/2">
                    <div class="mb-5">
                        <label for="country" class="mb-3 block text-base font-medium text-[#07074D]">
                            Country
                        </label>
                        <input type="text" name="country" id="country" required
                            class="w-full rounded-md border border-[#e0e0e0] bg-white py-3 px-6 text-base font-medium text-[#6B7280] outline-none focus:border-[#6A64F1] focus:shadow-md" />
                    </div>
                </div>
                <div class="w-full px-3 sm:w-1/2">
                    <div class="mb-5">
                        <label for="city" class="mb-3 block text-base font-medium text-[#07074D]">
                            City
                        </label>
                        <input type="text" name="city" id="city" required
                            class="w-full rounded-md border border-[#e0e0e0] bg-white py-3 px-6 text-base font-medium text-[#6B7280] outline-none focus:border-[#6A64F1] focus:shadow-md" />
                    </div>
                </div>
            </div>
            <div class="-mx-3 flex flex-wrap">
                <div class="w-full px-3 sm:w-1/2">
                    <div class="mb-5">
                        <label for="address" class="mb-3 block text-base font-medium text-[#07074D]">
                            Address
                        </label>
                        <input type="text" name="address" id="address" required
                            class="w-full rounded-md border border-[#e0e0e0] bg-white py-3 px-6 text-base font-medium text-[#6B7280] outline-none focus:border-[#6A64F1] focus:shadow-md" />
                    </div>
                </div>
                <div class="w-full px-3 sm:w-1/2">
                    <div class="mb-5">
                        <label for="zipcode" class="mb-3 block text-base font-medium text-[#07074D]">
                            Zip Code
                        </label>
                        <input type="text" name="zipcode" id="zipcode" required
                            class="w-full rounded-md border border-[#e0e0e0] bg-white py-3 px-6 text-base font-medium text-[#6B7280] outline-none focus:border-[#6A64F1] focus:shadow-md" />
                    </div>
                </div>
            </div>

            <div>
                <button type="submit"
                    class="hover:shadow-form w-full rounded-md bg-[#6A64F1] py-3 px-8 text-center text-base font-semibold text-white outline-none">
                    Checkout
                </button>
            </div>
        </form>
    </div>
</div>


{% endblock %}
{% block js %}
<script>
    if (localStorage.getItem('cart') == null) {
        document.getElementById('full_container').innerHTML = 'No products in the cart'
        var element = document.getElementById('checkout-form');
            element.classList.add('hidden');
    } else {
        cart = JSON.parse(localStorage.getItem('cart'))

        var cartHtml = "";
        var totalAmount = 0
        for (var x in cart) {
            var qte = cart[x][0]
            var price = cart[x][2]
            var title = cart[x][1]
            var amount = qte*price
            totalAmount += amount

            var container = '<div class="mx-auto w-full flex-none lg:max-w-2xl xl:max-w-3xl">'
                +'<div class="space-y-6">'
                    +'<div class="rounded-lg border border-gray-200 bg-white p-4 shadow-sm md:p-6">'
                        +'<div class="space-y-4 md:flex md:items-center md:justify-between md:gap-6 md:space-y-0">'
                            +'<a href="#" class="shrink-0 md:order-1"><img class="h-20 w-20" src="https://flowbite.s3.amazonaws.com/blocks/e-commerce/imac-front.svg" alt="imac image" /></a>'
                            +'<label for="counter-input" class="sr-only">Choose quantity:</label>'
                            +'<div class="flex items-center justify-between md:order-3 md:justify-end">'
                                +'<div class="flex items-center"><span class="inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-900 hover:underline">Qty: '+qte+'</span></div>'
                                +'<div class="text-end md:order-4 md:w-32"><p class="text-base font-bold text-gray-900">$'+amount+'</p></div>'
                            +'</div>'
                            +'<div class="w-full min-w-0 flex-1 space-y-4 md:order-2 md:max-w-md">'
                                +'<a href="#" class="text-base font-medium text-gray-900 hover:underline">'+title+'</a>'
                                +'<div class="flex items-center gap-4"><button type="button" class="inline-flex items-center text-sm font-medium text-red-600 hover:underline"> <svg class="me-1.5 h-5 w-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 17.94 6M18 18 6.06 6" /></svg>Remove</button></div>'
                            +'</div>'
                        +'</div>'
                    +'</div>'
                +'</div>'
            +'</div>'
            cartHtml += container
        }
        document.getElementById('cart_items').innerHTML = cartHtml
        document.getElementById('original-price').innerHTML = '$'+totalAmount
        document.getElementById('total-price').innerHTML = '$'+totalAmount
    }
    $('#items').val(JSON.stringify(cart))
    $('#amount').val('$'+totalAmount)

</script>
{% endblock %}